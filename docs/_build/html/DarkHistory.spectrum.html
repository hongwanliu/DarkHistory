

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DarkHistory.spectrum &mdash; DarkHistory  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="DarkHistory  documentation" href="index.html"/>
        <link rel="up" title="DarkHistory Modules" href="modules.html"/>
        <link rel="next" title="&lt;no title&gt;" href="DarkHistory.utilities.html"/>
        <link rel="prev" title="&lt;no title&gt;" href="DarkHistory.physics.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> DarkHistory
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">DarkHistory Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">DarkHistory.spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/DarkHistory.physics.html">DarkHistory.physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/DarkHistory.spectrum.html">DarkHistory.spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/DarkHistory.utilities.html">DarkHistory.utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/DarkHistory.TransferFunction.html">DarkHistory.TransferFunction</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DarkHistory</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">DarkHistory Modules</a> &raquo;</li>
        
      <li>DarkHistory.spectrum</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/DarkHistory.spectrum.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-DarkHistory.spectrum">
<span id="darkhistory-spectrum"></span><h1>DarkHistory.spectrum<a class="headerlink" href="#module-DarkHistory.spectrum" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">spectrum</span></code> contains functions and classes for processing spectral data.</p>
<p class="rubric">Methods</p>
<dl class="function">
<dt id="DarkHistory.spectrum.discretize">
<code class="descclassname">DarkHistory.spectrum.</code><code class="descname">discretize</code><span class="sig-paren">(</span><em>func_dNdE</em>, <em>eng</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.discretize" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretizes a continuous function.</p>
<p>The function is integrated between the bin boundaries specified by <cite>eng</cite> to obtain the discretized spectrum, so that the final spectrum conserves number and energy between the bin <strong>boundaries</strong>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func_dNdE</strong> (<em>function</em>) – A single variable function that takes in energy as an input, and then returns a dN/dE spectrum value.</li>
<li><strong>eng</strong> (<em>ndarray</em>) – Both the bin boundaries to integrate between and the new abscissa after discretization (bin centers).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The discretized spectrum. rs is set to -1, and must be set manually.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
</dd></dl>

<dl class="function">
<dt id="DarkHistory.spectrum.get_bin_bound">
<code class="descclassname">DarkHistory.spectrum.</code><code class="descname">get_bin_bound</code><span class="sig-paren">(</span><em>eng</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.get_bin_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bin boundary of an abscissa.</p>
<p>The bin boundaries are computed by taking the midpoint of the <strong>log</strong> of the abscissa. The first and last entries are computed by taking all of the bins to be symmetric with respect to the bin center.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>eng</strong> (<em>ndarray</em>) – Abscissa from which the bin boundary is obtained.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The bin boundaries.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="DarkHistory.spectrum.rebin_N_arr">
<code class="descclassname">DarkHistory.spectrum.</code><code class="descname">rebin_N_arr</code><span class="sig-paren">(</span><em>N_arr</em>, <em>in_eng</em>, <em>out_eng</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.rebin_N_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins an array of particle number with fixed energy.</p>
<p>Returns a <code class="docutils literal"><span class="pre">Spectrum</span></code> object. The rebinning conserves both total number and total energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>N_arr</strong> (<em>ndarray</em>) – An array of number of particles in each bin.</li>
<li><strong>in_eng</strong> (<em>ndarray</em>) – An array of the energy abscissa for each bin. The total energy in each bin <cite>i should be `N_arr[i]*in_eng[i]</cite>.</li>
<li><strong>out_eng</strong> (<em>ndarray</em>) – The new abscissa to bin into. If <cite>in_eng</cite> has values that are smaller than</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The output <code class="docutils literal"><span class="pre">Spectrum</span></code> with appropriate dN/dE, with abscissa out_eng.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">OverflowError</span></code> – The maximum energy in <cite>out_eng</cite> cannot be smaller than any bin in <cite>self.eng</cite>.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The total number and total energy is conserved by assigning the number of particles N in a bin of energy eng to two adjacent bins in new_eng, with energies eng_low and eng_upp such that eng_low &lt; eng &lt; eng_upp. Then dN_low_dE_low = (eng_upp - eng)/(eng_upp - eng_low)*(N/(E * dlogE_low)), and dN_upp_dE_upp = (eng - eng_low)/(eng_upp - eng_low)*(N/(E*dlogE_upp)).</p>
<p>If a bin in <cite>in_eng</cite> is below the lowest bin in <cite>out_eng</cite>, then the total number and energy not assigned to the lowest bin are assigned to the underflow. Particles will only be assigned to the lowest bin if there is some overlap between the bin index with respect to <cite>out_eng</cite> bin centers is larger than -1.0.</p>
<p class="last">If a bin in <cite>in_eng</cite> is above the highest bin in <cite>out_eng</cite>, then an <cite>OverflowError</cite> is thrown.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal"><span class="pre">spectrum.Spectrum.rebin()</span></code></p>
</div>
</dd></dl>

<p class="rubric">Classes</p>
<dl class="class">
<dt id="DarkHistory.spectrum.Spectrum">
<em class="property">class </em><code class="descclassname">DarkHistory.spectrum.</code><code class="descname">Spectrum</code><span class="sig-paren">(</span><em>eng</em>, <em>dNdE</em>, <em>rs=-1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure for photon and electron spectra with log-binning in energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>eng</strong> (<em>ndarray</em>) – Abscissa for the spectrum.</li>
<li><strong>dNdE</strong> (<em>ndarray</em>) – Spectrum stored as dN/dE.</li>
<li><strong>rs</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift (1+z) of the spectrum. Set to -1 if not specified.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectrum.length">
<code class="descname">length</code><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.length" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – The length of the <cite>eng</cite> and <cite>dNdE</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectrum.underflow">
<code class="descname">underflow</code><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.underflow" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict of str: float</em> – The underflow total number of particles and total energy.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectrum.log_bin_width">
<code class="descname">log_bin_width</code><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.log_bin_width" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – The log bin width.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectrum.bin_boundary">
<code class="descname">bin_boundary</code><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.bin_boundary" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – The boundary of each energy bin. Has one more entry than <cite>length</cite>.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectrum.contract" title="DarkHistory.spectrum.Spectrum.contract"><code class="xref py py-obj docutils literal"><span class="pre">contract</span></code></a>(mat)</td>
<td>Performs a dot product on the spectrum with <cite>mat</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectrum.rebin" title="DarkHistory.spectrum.Spectrum.rebin"><code class="xref py py-obj docutils literal"><span class="pre">rebin</span></code></a>(out_eng)</td>
<td>Re-bins the <code class="docutils literal"><span class="pre">Spectrum</span></code> object according to a new abscissa.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectrum.redshift" title="DarkHistory.spectrum.Spectrum.redshift"><code class="xref py py-obj docutils literal"><span class="pre">redshift</span></code></a>(new_rs)</td>
<td>Redshifts the <code class="docutils literal"><span class="pre">Spectrum</span></code> object as a photon spectrum.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectrum.shift_eng" title="DarkHistory.spectrum.Spectrum.shift_eng"><code class="xref py py-obj docutils literal"><span class="pre">shift_eng</span></code></a>(new_eng)</td>
<td>Shifts the abscissa while conserving number.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectrum.totN" title="DarkHistory.spectrum.Spectrum.totN"><code class="xref py py-obj docutils literal"><span class="pre">totN</span></code></a>([bound_type,&nbsp;bound_arr])</td>
<td>Returns the total number of particles in part of the spectrum.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectrum.toteng" title="DarkHistory.spectrum.Spectrum.toteng"><code class="xref py py-obj docutils literal"><span class="pre">toteng</span></code></a>([bound_type,&nbsp;bound_arr])</td>
<td>Returns the total energy of particles in part of the spectrum.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__add__">
<code class="descname">__add__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds two Spectrum instances together, or an array to the spectrum. The <code class="docutils literal"><span class="pre">Spectrum</span></code> object is on the left.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum"><em>Spectrum</em></a><em>, </em><em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the summed spectrum.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__radd__</cite>, allows the use of the symbol + to add <code class="docutils literal"><span class="pre">Spectrum</span></code> objects together.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object <cite>underflow</cite> is reset to zero if <cite>other</cite> is not a <code class="docutils literal"><span class="pre">Spectrum</span></code> object.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.__radd__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__mul__">
<code class="descname">__mul__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the product of the spectrum with an array or number. <cite>Spectrum</cite> object is on the left.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum"><em>Spectrum</em></a><em>, </em><em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the multiplied <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__rmul__</cite>, allows the use of the symbol * to multiply <code class="docutils literal"><span class="pre">Spectrum</span></code> objects or an array and Spectrum.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object <cite>underflow</cite> is reset to zero if <cite>other</cite> is not a <code class="docutils literal"><span class="pre">Spectrum</span></code> object.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.__rmul__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__neg__">
<code class="descname">__neg__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__neg__" title="Permalink to this definition">¶</a></dt>
<dd><p>Negates the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance with the spectrum negated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__radd__">
<code class="descname">__radd__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__radd__" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds two Spectrum instances together, or an array to the spectrum. The <code class="docutils literal"><span class="pre">Spectrum</span></code> object is on the right.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum"><em>Spectrum</em></a><em>, </em><em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the summed spectrum.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__add__</cite>, allows the use of the symbol + to add <code class="docutils literal"><span class="pre">Spectrum</span></code> objects together.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object <cite>underflow</cite> is reset to zero if <cite>other</cite> is not a <code class="docutils literal"><span class="pre">Spectrum</span></code> object.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.__add__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__rmul__">
<code class="descname">__rmul__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__rmul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the product of the spectrum with an array or number. <cite>Spectrum</cite> object is on the right.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the multiplied <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__mul__</cite>, allows the use of the symbol * to multiply <code class="docutils literal"><span class="pre">Spectrum</span></code> objects or an array and Spectrum.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object <cite>underflow</cite> is reset to zero if <cite>other</cite> is not a <code class="docutils literal"><span class="pre">Spectrum</span></code> object.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.__mul__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__rsub__">
<code class="descname">__rsub__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__rsub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts one Spectrum instance from another, or subtracts the spectrum from an array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum"><em>Spectrum</em></a><em> or </em><em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the subtracted <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__sub__</cite>, allows the use of the symbol - to subtract or subtract from <code class="docutils literal"><span class="pre">Spectrum</span></code> objects.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.__sub__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__rtruediv__">
<code class="descname">__rtruediv__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__rtruediv__" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides a number or array by the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the divided <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__truediv__</cite>, allows the use of the symbol / to multiply <code class="docutils literal"><span class="pre">Spectrum</span></code> objects or an array and Spectrum.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object <cite>underflow</cite> is reset to zero.</p>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__sub__">
<code class="descname">__sub__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts one <code class="docutils literal"><span class="pre">Spectrum</span></code> instance from another, or subtracts an array from the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum"><em>Spectrum</em></a><em> or </em><em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the subtracted <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__rsub__</cite>, allows the use of the symbol - to subtract or subtract from <code class="docutils literal"><span class="pre">Spectrum</span></code> objects.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object underflow is reset to zero if <cite>other</cite> is not a <code class="docutils literal"><span class="pre">Spectrum</span></code> object.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.__rsub__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.__truediv__">
<code class="descname">__truediv__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.__truediv__" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides the spectrum by an array or number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectrum</span></code> instance which has the divided <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum">Spectrum</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectrum.__truediv__</cite>, allows the use of the symbol / to multiply <code class="docutils literal"><span class="pre">Spectrum</span></code> objects or an array and <code class="docutils literal"><span class="pre">Spectrum</span></code>.</p>
<p>The returned <code class="docutils literal"><span class="pre">Spectrum</span></code> object <cite>underflow</cite> is reset to zero.</p>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.contract">
<code class="descname">contract</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a dot product on the spectrum with <cite>mat</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mat</strong> (<em>ndarray</em>) – The array to dot into the spectrum with.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The resulting dot product.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.rebin">
<code class="descname">rebin</code><span class="sig-paren">(</span><em>out_eng</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.rebin" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-bins the <code class="docutils literal"><span class="pre">Spectrum</span></code> object according to a new abscissa.</p>
<p>Rebinning conserves total number and total energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_eng</strong> (<em>ndarray</em>) – The new abscissa to bin into. If <cite>self.eng</cite> has values that are smaller than <cite>out_eng[0]</cite>, then the new underflow will be filled. If <cite>self.eng</cite> has values that exceed <cite>out_eng[-1]</cite>, then an error is returned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">OverflowError</span></code> – The maximum energy in <cite>out_eng</cite> cannot be smaller than any bin in <cite>self.eng</cite>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The total number and total energy is conserved by assigning the number of particles N in a bin of energy eng to two adjacent bins in new_eng, with energies eng_low and eng_upp such that eng_low &lt; eng &lt; eng_upp. Then dN_low_dE_low = (eng_upp - eng)/(eng_upp - eng_low)*(N/(E * dlogE_low)), and dN_upp_dE_upp = (eng - eng_low)/(eng_upp - eng_low)*(N/(E*dlogE_upp)).</p>
<p>If a bin in <cite>self.eng</cite> is below the lowest bin in <cite>out_eng</cite>, then the total number and energy not assigned to the lowest bin are assigned to the underflow. Particles will only be assigned to the lowest bin if there is some overlap between the bin index with respect to <cite>out_eng</cite> bin centers is larger than -1.0.</p>
<p class="last">If a bin in <cite>self.eng</cite> is above the highest bin in <cite>out_eng</cite>, then an <cite>OverflowError</cite> is thrown.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.rebin_N_arr()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.redshift">
<code class="descname">redshift</code><span class="sig-paren">(</span><em>new_rs</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Redshifts the <code class="docutils literal"><span class="pre">Spectrum</span></code> object as a photon spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_rs</strong> (<em>float</em>) – The new redshift (1+z) to redshift to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.shift_eng">
<code class="descname">shift_eng</code><span class="sig-paren">(</span><em>new_eng</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.shift_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the abscissa while conserving number.</p>
<p>This function can be used to subtract or add some amount of energy from each bin in the spectrum. The dN/dE is adjusted to conserve number in each bin.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_eng</strong> (<em>ndarray</em>) – The new energy abscissa.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.totN">
<code class="descname">totN</code><span class="sig-paren">(</span><em>bound_type=None</em>, <em>bound_arr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.totN" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total number of particles in part of the spectrum.</p>
<p>The part of the spectrum can be specified in two ways, and is specified by <cite>bound_type</cite>. Multiple totals can be obtained through <cite>bound_arr</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bound_type</strong> (<em>{'bin'</em><em>, </em><em>'eng'</em><em>, </em><em>None}</em>) – The type of bounds to use. Bound values do not have to be within the [0:length] for <cite>‘bin’</cite> or within the abscissa for <cite>‘eng’</cite>. <cite>None</cite> should only be used when computing the total particle number in the spectrum. For <cite>‘bin’</cite>, bounds are specified as the bin boundary, with 0 being the left most boundary, 1 the right-hand of the first bin and so on. This is equivalent to integrating over a histogram. For <cite>‘eng’</cite>, bounds are specified by energy values.</li>
<li><strong>bound_arr</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – An array of boundaries (bin or energy), between which the total number of particles will be computed. If unspecified, the total number of particles in the whole spectrum is computed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Total number of particles in the spectrum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray or float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectrum.toteng">
<code class="descname">toteng</code><span class="sig-paren">(</span><em>bound_type=None</em>, <em>bound_arr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectrum.toteng" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total energy of particles in part of the spectrum.</p>
<p>The part of the spectrum can be specified in two ways, and is specified by <cite>bound_type</cite>. Multiple totals can be obtained through <cite>bound_arr</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bound_type</strong> (<em>{'bin'</em><em>, </em><em>'eng'</em><em>, </em><em>None}</em>) – The type of bounds to use. Bound values do not have to be within the [0:length] for <cite>‘bin’</cite> or within the abscissa for <cite>‘eng’</cite>. <cite>None</cite> should only be used to obtain the total energy. With <cite>‘bin’</cite>, bounds are specified as the bin boundary, with 0 being the left most boundary, 1 the right-hand of the first bin and so on. This is equivalent to integrating over a histogram. With <cite>‘eng’</cite>, bounds are specified by energy values.</li>
<li><strong>bound_arr</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – An array of boundaries (bin or energy), between which the total number of particles will be computed. If unspecified, the total number of particles in the whole spectrum is computed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Total energy in the spectrum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray or float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="DarkHistory.spectrum.Spectra">
<em class="property">class </em><code class="descclassname">DarkHistory.spectrum.</code><code class="descname">Spectra</code><span class="sig-paren">(</span><em>spec_arr</em>, <em>rebin_eng=None</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure for a collection of <code class="docutils literal"><span class="pre">Spectrum</span></code> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spec_arr</strong> (list of <code class="docutils literal"><span class="pre">Spectrum</span></code>) – List of <code class="docutils literal"><span class="pre">Spectrum</span></code> to be stored together.</li>
<li><strong>rebin_eng</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – New abscissa to rebin all of the <code class="docutils literal"><span class="pre">Spectrum</span></code> objects into.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectra.eng">
<code class="descname">eng</code><a class="headerlink" href="#DarkHistory.spectrum.Spectra.eng" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – Energy abscissa for the <code class="docutils literal"><span class="pre">Spectrum</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectra.rs">
<code class="descname">rs</code><a class="headerlink" href="#DarkHistory.spectrum.Spectra.rs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – The redshifts of the <code class="docutils literal"><span class="pre">Spectrum</span></code> objects.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectra.log_bin_width">
<code class="descname">log_bin_width</code><a class="headerlink" href="#DarkHistory.spectrum.Spectra.log_bin_width" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – The log bin width.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectra.bin_boundary">
<code class="descname">bin_boundary</code><a class="headerlink" href="#DarkHistory.spectrum.Spectra.bin_boundary" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – The boundary of each energy bin. Has one more entry than <cite>length</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="DarkHistory.spectrum.Spectra.grid_values">
<code class="descname">grid_values</code><a class="headerlink" href="#DarkHistory.spectrum.Spectra.grid_values" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – 2D array with the spectra laid out in (rs, eng).</p>
</dd></dl>

<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectra.append" title="DarkHistory.spectrum.Spectra.append"><code class="xref py py-obj docutils literal"><span class="pre">append</span></code></a>(spec)</td>
<td>Appends a new <code class="docutils literal"><span class="pre">Spectrum</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectra.integrate_each_spec" title="DarkHistory.spectrum.Spectra.integrate_each_spec"><code class="xref py py-obj docutils literal"><span class="pre">integrate_each_spec</span></code></a>([weight])</td>
<td>Sums each <code class="docutils literal"><span class="pre">Spectrum</span></code>, each <cite>eng</cite> bin weighted by <cite>weight</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectra.plot" title="DarkHistory.spectrum.Spectra.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>(ind[,&nbsp;step])</td>
<td>Plots the contained <code class="docutils literal"><span class="pre">Spectrum</span></code> objects.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectra.rebin" title="DarkHistory.spectrum.Spectra.rebin"><code class="xref py py-obj docutils literal"><span class="pre">rebin</span></code></a>(out_eng)</td>
<td>Re-bins all <code class="docutils literal"><span class="pre">Spectrum</span></code> objects according to a new abscissa.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#DarkHistory.spectrum.Spectra.sum_specs" title="DarkHistory.spectrum.Spectra.sum_specs"><code class="xref py py-obj docutils literal"><span class="pre">sum_specs</span></code></a>([weight])</td>
<td>Sums the spectrum in each energy bin, weighted by <cite>mat</cite>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__add__">
<code class="descname">__add__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds two <code class="docutils literal"><span class="pre">Spectra</span></code> instances together.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra"><em>Spectra</em></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance which is an element-wise sum of the <code class="docutils literal"><span class="pre">Spectrum</span></code> objects in each <code class="docutils literal"><span class="pre">Spectra</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__radd__</cite>, allows the use of the symbol + to add <code class="docutils literal"><span class="pre">Spectra</span></code> objects together.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__radd__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__mul__">
<code class="descname">__mul__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the product of two <code class="docutils literal"><span class="pre">Spectra</span></code> instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra"><em>Spectra</em></a><em>, </em><em>int</em><em> or </em><em>float</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance which is an element-wise product of the <code class="docutils literal"><span class="pre">Spectrum</span></code> objects in each <code class="docutils literal"><span class="pre">Spectra</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__rmul__</cite>, allows the use of the symbol * to add <code class="docutils literal"><span class="pre">Spectra</span></code> objects together.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__rmul__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__neg__">
<code class="descname">__neg__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__neg__" title="Permalink to this definition">¶</a></dt>
<dd><p>Negates all of the <cite>dNdE</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance with the <cite>dNdE</cite> negated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__radd__">
<code class="descname">__radd__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__radd__" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds two <code class="docutils literal"><span class="pre">Spectra</span></code> instances together.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra"><em>Spectra</em></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance which is an element-wise sum of the <code class="docutils literal"><span class="pre">Spectrum</span></code> objects in each <code class="docutils literal"><span class="pre">Spectra</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__add__</cite>, allows the use of the symbol + to add <cite>Spectra</cite> objects together.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__add__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__rmul__">
<code class="descname">__rmul__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__rmul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the product of two <code class="docutils literal"><span class="pre">Spectra</span></code> instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra"><em>Spectra</em></a><em>, </em><em>int</em><em> or </em><em>float</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance which is an element-wise product of the <code class="docutils literal"><span class="pre">Spectrum</span></code> objects in each <code class="docutils literal"><span class="pre">Spectra</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__mul__</cite>, allows the use of the symbol * to add <code class="docutils literal"><span class="pre">Spectra</span></code> objects together.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__mul__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__rsub__">
<code class="descname">__rsub__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__rsub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts one <code class="docutils literal"><span class="pre">Spectra</span></code> instance from another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra"><em>Spectra</em></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance which has the subtracted list of <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__rsub__</cite>, allows the use of the symbol - to subtract or subtract from <cite>Spectra</cite> objects.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__sub__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__rtruediv__">
<code class="descname">__rtruediv__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__rtruediv__" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides <code class="docutils literal"><span class="pre">Spectra</span></code> by a number or another <code class="docutils literal"><span class="pre">Spectra</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__truediv__</cite>, allows the use of the symbol / to divide <code class="docutils literal"><span class="pre">Spectra</span></code> objects by a number or another <code class="docutils literal"><span class="pre">Spectra</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__truediv__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__sub__">
<code class="descname">__sub__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts one <code class="docutils literal"><span class="pre">Spectra</span></code> instance from another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra"><em>Spectra</em></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New <code class="docutils literal"><span class="pre">Spectra</span></code> instance which has the subtracted list of <cite>dNdE</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__rsub__</cite>, allows the use of the symbol - to subtract or subtract from <cite>Spectra</cite> objects.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__rsub__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.__truediv__">
<code class="descname">__truediv__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.__truediv__" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides <code class="docutils literal"><span class="pre">Spectra</span></code> by a number or another <code class="docutils literal"><span class="pre">Spectra</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>ndarray</em><em>, </em><em>float</em><em> or </em><em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#DarkHistory.spectrum.Spectra" title="DarkHistory.spectrum.Spectra">Spectra</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This special function, together with <cite>Spectra.__rtruediv__</cite>, allows the use of the symbol / to divide <code class="docutils literal"><span class="pre">Spectra</span></code> objects by a number or another <code class="docutils literal"><span class="pre">Spectra</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectra.__rtruediv__()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>spec</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new <code class="docutils literal"><span class="pre">Spectrum</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spec</strong> (<a class="reference internal" href="#DarkHistory.spectrum.Spectrum" title="DarkHistory.spectrum.Spectrum"><em>Spectrum</em></a>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.integrate_each_spec">
<code class="descname">integrate_each_spec</code><span class="sig-paren">(</span><em>weight=None</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.integrate_each_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums each <code class="docutils literal"><span class="pre">Spectrum</span></code>, each <cite>eng</cite> bin weighted by <cite>weight</cite>.</p>
<p>Equivalent to contracting <cite>weight</cite> with each <cite>dNdE</cite> in <code class="docutils literal"><span class="pre">Spectra</span></code>, <cite>weight</cite> should have length <cite>self.length</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weight</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The weight in each energy bin, with weight of 1 for every bin if not specified.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array of weighted sums, one for each redshift in <cite>self.rs</cite>, with length <cite>self.rs.size</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ind</em>, <em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the contained <code class="docutils literal"><span class="pre">Spectrum</span></code> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ind</strong> (<em>int</em><em> or </em><em>tuple of int</em>) – Index of <code class="docutils literal"><span class="pre">Spectrum</span></code> to plot, or a tuple of indices providing a range of <code class="docutils literal"><span class="pre">Spectrum</span></code> to plot.</li>
<li><strong>step</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of steps to take before choosing one <code class="docutils literal"><span class="pre">Spectrum</span></code> to plot.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matplotlib.figure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.rebin">
<code class="descname">rebin</code><span class="sig-paren">(</span><em>out_eng</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.rebin" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-bins all <code class="docutils literal"><span class="pre">Spectrum</span></code> objects according to a new abscissa.</p>
<p>Rebinning conserves total number and total energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_eng</strong> (<em>ndarray</em>) – The new abscissa to bin into. If <cite>self.eng</cite> has values that are smaller than <cite>out_eng[0]</cite>, then the new underflow will be filled. If <cite>self.eng</cite> has values that exceed <cite>out_eng[-1]</cite>, then an error is returned.</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">spectrum.Spectrum.rebin()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="DarkHistory.spectrum.Spectra.sum_specs">
<code class="descname">sum_specs</code><span class="sig-paren">(</span><em>weight=None</em><span class="sig-paren">)</span><a class="headerlink" href="#DarkHistory.spectrum.Spectra.sum_specs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums the spectrum in each energy bin, weighted by <cite>mat</cite>.</p>
<p>Equivalent to contracting <cite>mat</cite> with <cite>[spec.dNdE[i] for spec in spec_arr]</cite> for all <cite>i</cite>. <cite>mat</cite> should have length <cite>self.rs.size</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weight</strong> (ndarray or <code class="docutils literal"><span class="pre">Spectrum</span></code>, optional) – The weight in each redshift bin, with weight of 1 for every bin if not specified.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array or <code class="docutils literal"><span class="pre">Spectrum</span></code> of weight sums, one for each energy in <cite>self.eng</cite>, with length <cite>self.length</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray or <code class="docutils literal"><span class="pre">Spectrum</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="DarkHistory.utilities.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="DarkHistory.physics.html" class="btn btn-neutral" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Hongwan Liu.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>